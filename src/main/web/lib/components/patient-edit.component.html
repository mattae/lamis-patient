<div class="lamis-edit-form">
    <div class="lamis-edit-form-container">
        <form name="form" role="form" novalidate (ngSubmit)="save()" #patientForm="ngForm">
            <mat-card class="default">
                <mat-card-content>
                    <mat-divider></mat-divider>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Hospital Number</mat-label>
                                <input matInput [(ngModel)]="entity.hospitalNum" #hospitalNum="ngModel"
                                       [required]="!entity.id"
                                       uniqueHospitalNum
                                       [disabled]="!!entity.id"
                                       name="hospitalNum"/>
                                <mat-error
                                        *ngIf="hospitalNum.errors && (hospitalNum.dirty || hospitalNum.touched) && (hospitalNum.errors.required)">
                                    Hospital Number is required
                                </mat-error>
                                <mat-error
                                        *ngIf="hospitalNum.errors && (hospitalNum.dirty || hospitalNum.touched) && (hospitalNum.errors.numberExists)">
                                    Hospital Number is used by another patient
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Unique ID</mat-label>
                                <input matInput [(ngModel)]="entity.uniqueId" name="uniqueId"/>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6" *ngIf="!!minDateRegistration">
                            <mat-form-field class="full-width">
                                <input matInput [matDatepicker]="picker"
                                       placeholder="Date of Registration/Transfer-In"
                                       [(ngModel)]="entity.dateRegistration"
                                       #registration="ngModel"
                                       [max]="today"
                                       [min]="minDateRegistration"
                                       (dateChange)="dateRegistrationChanged($event.value)"
                                       name="registration"
                                       required>
                                <mat-datepicker-toggle
                                        matSuffix
                                        [for]="picker">
                                </mat-datepicker-toggle>
                                <mat-datepicker #picker></mat-datepicker>
                                <mat-error
                                        *ngIf="registration.errors && (registration.dirty || registration.touched || !!entity.id) && (registration.errors.required)">
                                    Date of Registration is required
                                </mat-error>
                                <mat-error
                                        *ngIf="registration.errors && (registration.dirty || registration.touched || !!entity.id) && (registration.errors.min)">
                                    Date of Registration cannot be before {{minDateRegistration | date: 'dd MMM, yyyy'}}
                                </mat-error>
                                <mat-error
                                        *ngIf="registration.errors && (registration.dirty || registration.touched || !!entity.id) && (registration.errors.max)">
                                    Date of Registration cannot be in the future
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Surname</mat-label>
                                <input matInput [(ngModel)]="entity.surname" #sn="ngModel"
                                       required
                                       [minLength]="2"
                                       name="sn"/>
                                <mat-error
                                        *ngIf="sn.errors && (sn.dirty || sn.touched || !!entity.id) && (sn.errors.required)">
                                    Surname is required
                                </mat-error>
                                <mat-error
                                        *ngIf="sn.errors && (sn.dirty || sn.touched || !!entity.id) && (sn.errors.minLength)">
                                    Minimum length for Surname is 2 characters
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Other Names</mat-label>
                                <input matInput [(ngModel)]="entity.otherNames" #on="ngModel"
                                       required
                                       [minLength]="5"
                                       name="on"/>
                                <mat-error
                                        *ngIf="on.errors && (on.dirty || on.touched || !!entity.id) && (on.errors.required)">
                                    Other Names required
                                </mat-error>
                                <mat-error
                                        *ngIf="on.errors && (on.dirty || on.touched || !!entity.id) && (on.errors.minLength)">
                                    Minimum length for Other Names is 5 characters
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <div *ngIf="!entity.id">
                        <fieldset>
                            <div class="row">
                                <div class="col-md-6">
                                    <mat-checkbox [(ngModel)]="entity.dobEstimated" name="est">Age Estimated?
                                    </mat-checkbox>
                                </div>
                                <div class="col-md-6">
                                    <div *ngIf="entity.dobEstimated" class="row">
                                        <div class="col-md-6">
                                            <mat-form-field class="full-width">
                                                <mat-label>Age at Registration</mat-label>
                                                <input matInput [(ngModel)]="age" required
                                                       [min]="2"
                                                       [max]="70"
                                                       (change)="estimateDob()"
                                                       name="age" #age1="ngModel">
                                                <mat-error
                                                        *ngIf="age1.errors && (age1.dirty || age1.touched) && (age1.errors.min)">
                                                    Minimum age is 2
                                                </mat-error>
                                                <mat-error
                                                        *ngIf="age1.errors && (age1.dirty || age1.touched) && (age1.errors.max)">
                                                    Maximum age is 70
                                                </mat-error>
                                                <mat-error
                                                        *ngIf="age1.errors && (age1.dirty || age1.touched) && (age1.errors.required)">
                                                    Estimated age is required
                                                </mat-error>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-6">
                                            <mat-form-field class="full-width">
                                                <mat-label>Age Units</mat-label>
                                                <mat-select [(ngModel)]="ageUnit"
                                                            (selectionChange)="estimateDob()"
                                                            required name="units" #units="ngModel">
                                                    <mat-option></mat-option>
                                                    <mat-option [value]="'years'">Year(s)</mat-option>
                                                    <mat-option [value]="'months'">Month(s)</mat-option>
                                                </mat-select>
                                                <mat-error
                                                        *ngIf="units.errors && (units.dirty || units.touched) && (units.errors.required)">
                                                    Age units is required
                                                </mat-error>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div>
                                        <mat-form-field class="full-width" *ngIf="!entity.dobEstimated">
                                            <input matInput [matDatepicker]="picker1"
                                                   placeholder="Date of Birth"
                                                   [(ngModel)]="entity.dateBirth"
                                                   [min]="minDob"
                                                   (dateChange)="dateBirthChanged($event.value)"
                                                   required
                                                   [max]="maxDateBirth"
                                                   #dob1="ngModel"
                                                   name="dob">
                                            <mat-datepicker-toggle
                                                    matSuffix
                                                    [for]="picker1">
                                            </mat-datepicker-toggle>
                                            <mat-datepicker #picker1></mat-datepicker>
                                            <mat-error
                                                    *ngIf="dob1.errors && (dob1.dirty || dob1.touched) && (dob1.errors.required)">
                                                Date of Birth is required
                                            </mat-error>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <div *ngIf="entity.id">
                        <div class="row">
                            <div class="col-md-6">
                                <mat-form-field class="full-width" *ngIf="minDob">
                                    <input matInput [matDatepicker]="picker2"
                                           placeholder="Date of Birth"
                                           [(ngModel)]="entity.dateBirth"
                                           #birth="ngModel"
                                           (dateChange)="dateBirthChanged($event.value)"
                                           [max]="maxDateBirth"
                                           [min]="minDob"
                                           name="dob"
                                           required>
                                    <mat-datepicker-toggle
                                            matSuffix
                                            [for]="picker2">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #picker2></mat-datepicker>
                                    <mat-error
                                            *ngIf="birth.errors && (birth.dirty || birth.touched || !!entity.id) && (birth.errors.required)">
                                        Date of Birth is required
                                    </mat-error>
                                    <mat-error
                                            *ngIf="birth.errors && (birth.dirty || birth.touched || !!entity.id) && (birth.errors.max)">
                                        Date of Birth cannot be after Date of Registration
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Gender</mat-label>
                                <mat-select [(ngModel)]="entity.gender"
                                            required name="gender" #gender="ngModel">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'FEMALE'">Female</mat-option>
                                    <mat-option [value]="'MALE'">Male</mat-option>
                                </mat-select>
                                <mat-error
                                        *ngIf="gender.errors && (gender.dirty || gender.touched || !!entity.id) && (gender.errors.required)">
                                    Gender is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Marital Status</mat-label>
                                <mat-select [(ngModel)]="entity.maritalStatus"
                                            required name="status" #status="ngModel">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'Single'">Single</mat-option>
                                    <mat-option [value]="'Married'">Married</mat-option>
                                    <mat-option [value]="'Widowed'">Widowed</mat-option>
                                    <mat-option [value]="'Separated'">Separated</mat-option>
                                    <mat-option [value]="'Divorced'">Divorced</mat-option>
                                </mat-select>
                                <mat-error
                                        *ngIf="status.errors && (status.dirty || status.touched || !!entity.id) && (status.errors.required)">
                                    Marital Status is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Job /Occupation Status</mat-label>
                                <mat-select name="occupation" [(ngModel)]="entity.occupation">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'Unemployed'">Unemployed</mat-option>
                                    <mat-option [value]="'Employed'">Employed</mat-option>
                                    <mat-option [value]="'Student'">Student</mat-option>
                                    <mat-option [value]="'Retired'">Retired</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Educational Level</mat-label>
                                <mat-select name="education" [(ngModel)]="entity.education">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'None'">None</mat-option>
                                    <mat-option [value]="'Primary'">Primary</mat-option>
                                    <mat-option [value]="'Senior Secondary'">Senior Secondary</mat-option>
                                    <mat-option [value]="'Quranic'">Quranic</mat-option>
                                    <mat-option [value]="'Junior Secondary'">Junior Secondary</mat-option>
                                    <mat-option [value]="'Post Secondary'">Post Secondary</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>State of Residence</mat-label>
                                <mat-select name="state" [(ngModel)]="state"
                                            [compareWith]="entityCompare"
                                            (selectionChange)="stateChange($event.value.id)">
                                    <mat-option></mat-option>
                                    <mat-option *ngFor="let state of states" [value]="state">{{state.name}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>LGA of Residence</mat-label>
                                <mat-select name="lga" [(ngModel)]="entity.lga" required #lga="ngModel"
                                            [compareWith]="entityCompare">
                                    <mat-option></mat-option>
                                    <mat-option *ngFor="let lga of lgas" [value]="lga">{{lga.name}}</mat-option>
                                </mat-select>
                                <mat-error
                                        *ngIf="lga.errors && (lga.dirty || lga.touched || !!entity.id) && (lga.errors.required)">
                                    LGA of Residence is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label class="form-label">Address</mat-label>
                                <textarea name="address" matInput [(ngModel)]="entity.address"
                                          rows="3"
                                          required #address="ngModel"></textarea>
                                <mat-error
                                        *ngIf="address.errors && (address.dirty || address.touched || !!entity.id) && (address.errors.required)">
                                    Address is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Telephone Number</mat-label>
                                <input matInput name="phone" phoneNumber [(ngModel)]="entity.phone" #phone="ngModel"/>
                                <mat-error
                                        *ngIf="phone.errors && (phone.dirty || phone.touched || !!entity.id) && (phone.errors.invalidPhone)">
                                    Invalid phone number
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>HIV Status at Registration</mat-label>
                                <mat-select name="statusRegistration" [(ngModel)]="entity.statusAtRegistration"
                                            (selectionChange)="statusChanged()"
                                            required #status="ngModel">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'HIV_EXPOSED_STATUS_UNKNOWN'">HIV Exposed Status Unknown
                                    </mat-option>
                                    <mat-option [value]="'HIV_PLUS_NON_ART'">HIV+ non ART</mat-option>
                                    <mat-option [value]="'ART_TRANSFER_IN'">ART Transfer In</mat-option>
                                    <mat-option [value]="'PRE_ART_TRANSFER_IN'">Pre-ART Transfer In</mat-option>
                                    <mat-option [value]="'HIV_NEGATIVE'">HIV Negative</mat-option>
                                </mat-select>
                                <mat-error
                                        *ngIf="status.errors && (status.dirty || status.touched || !!entity.id) && (status.errors.required)">
                                    HIV Status at Registration is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Care Entry Point</mat-label>
                                <mat-select name="entryPoint" [(ngModel)]="entity.entryPoint"
                                            #entryPoint="ngModel">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'OPD'">OPD</mat-option>
                                    <mat-option [value]="'In-patient'">In-patient</mat-option>
                                    <mat-option [value]="'HCT'">HCT</mat-option>
                                    <mat-option [value]="'TB DOTS'">TB DOTS</mat-option>
                                    <mat-option [value]="'STI Clinic'">STI Clinic</mat-option>
                                    <mat-option [value]="'PMTCT'">PMTCT</mat-option>
                                    <mat-option [value]="'Transfer-in'">Transfer-in</mat-option>
                                    <mat-option [value]="'Outreach'">Outreach</mat-option>
                                    <mat-option [value]="'OVC Partner'">OVC Partner</mat-option>
                                    <mat-option [value]="'Others'">Others</mat-option>
                                </mat-select>
                                <mat-error
                                        *ngIf="entryPoint.errors && (entryPoint.dirty || entryPoint.touched || !!entity.id) && (entryPoint.errors.required)">
                                    Care Entry Point is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <ng-container *ngIf="prep">
                        <fieldset>
                            <legend>PrEP</legend>
                            <div class="row">
                                <div class="col-md-6">
                                    <mat-form-field class="full-width">
                                        <mat-label>PrEP ID</mat-label>
                                        <input matInput name="prepId" required [(ngModel)]="prepId" #prepID="ngModel"/>
                                        <mat-error
                                                *ngIf="prepID.errors && (prepID.dirty || prepID.touched || !!entity.id) && (prepID.errors.required)">
                                            PrEP ID is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <mat-form-field class="full-width">
                                        <mat-label>Indication for PrEP</mat-label>
                                        <mat-select name="indication" required #indication="ngModel"
                                                    [(ngModel)]="indicationForPrep">
                                            <mat-option></mat-option>
                                            <mat-option [value]="'Sero-Discordant Relationship'">Sero-Discordant
                                                Relationship
                                            </mat-option>
                                            <mat-option [value]="'On Demand'">On Demand</mat-option>
                                        </mat-select>
                                        <mat-error
                                                *ngIf="indication.errors && (indication.dirty || indication.touched || !!entity.id) && (indication.errors.required)">
                                            Indication for PrEP is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-6" *ngIf="indicationForPrep === 'On Demand'">
                                    <mat-form-field class="full-width">
                                        <mat-label>On Demand Type</mat-label>
                                        <mat-select name="type" required #type="ngModel"
                                                    [(ngModel)]="onDemandIndication">
                                            <mat-option></mat-option>
                                            <mat-option [value]="'Partner Non-disclosure'">Partner Non-disclosure
                                            </mat-option>
                                            <mat-option [value]="'Partner unwilling to undergo HIV testing'">Partner
                                                unwilling to undergo HIV testing
                                            </mat-option>
                                            <mat-option [value]="'Client unable to negotiate condom use'">Client unable
                                                to negotiate condom use
                                            </mat-option>
                                            <mat-option [value]="'Individuals with high risk sexual behaviors'">
                                                Individuals with high risk sexual behaviors
                                            </mat-option>
                                            <mat-option [value]="'Others'">Others</mat-option>
                                        </mat-select>
                                        <mat-error
                                                *ngIf="type.errors && (type.dirty || type.touched || !!entity.id) && (type.errors.required)">
                                            On Demand is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                        </fieldset>
                    </ng-container>
                    <div class="row" *ngIf="entity.gender === 'FEMALE'">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Time of HIV Diagnosis</mat-label>
                                <mat-select name="timeHivDiagnosis" [(ngModel)]="entity.timeHivDiagnosis">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'Previous - Non pregnant'">Previous - Non pregnant</mat-option>
                                    <mat-option [value]="'Previous pregnancy (ANC)'">Previous pregnancy (ANC)
                                    </mat-option>
                                    <mat-option [value]="'Previous pregnancy (L&amp;D)'">Previous pregnancy (L&amp;D)
                                    </mat-option>
                                    <mat-option [value]="'Previous pregnancy (PP &lt;72hrs)'">Previous pregnancy (PP
                                        &lt;72hrs)
                                    </mat-option>
                                    <mat-option [value]="'ANC'">ANC</mat-option>
                                    <mat-option [value]="'Labour'">Labour</mat-option>
                                    <mat-option [value]="'Post Partum &lt;=72hrs'">Post Partum &lt;=72hrs</mat-option>
                                    <mat-option [value]="'Post Partum &gt;72hrs'">Post Partum &gt;72hrs</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Date enrolled into PMTCT</mat-label>
                                <input matInput [matDatepicker]="picker3"
                                       [(ngModel)]="entity.dateEnrolledPMTCT"
                                       #pmtct="ngModel"
                                       [max]="entity.dateRegistration"
                                       [min]="entity.dateBirth"
                                       name="pmtct">
                                <mat-datepicker-toggle
                                        matSuffix
                                        [for]="picker3">
                                </mat-datepicker-toggle>
                                <mat-datepicker #picker3></mat-datepicker>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row" *ngIf="entity.gender === 'FEMALE'">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Pregnancy Status</mat-label>
                                <mat-select name="pregnancyStatus" [(ngModel)]="entity.pregnancyStatus">
                                    <mat-option></mat-option>
                                    <mat-option value="1">Not Pregnant</mat-option>
                                    <mat-option value="2">Pregnant</mat-option>
                                    <mat-option value="3">Breastfeeding</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>Source of Referral</mat-label>
                                <mat-select name="sourceReferral" [(ngModel)]="entity.sourceReferral">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'PMTCT outreach'">PMTCT outreach</mat-option>
                                    <mat-option [value]="'Sex worker outreach'">Sex worker outreach</mat-option>
                                    <mat-option [value]="'Medical outpatient'">Medical outpatient</mat-option>
                                    <mat-option [value]="'Youth/Adolescent outreach'">Youth/Adolescent outreach
                                    </mat-option>
                                    <mat-option [value]="'Private/Commercial Health facility'">Private/Commercial Health
                                        facility
                                    </mat-option>
                                    <mat-option [value]="'Under-fives/Immunization clinic'">Under-fives/Immunization
                                        clinic
                                    </mat-option>
                                    <mat-option [value]="'External HCT centre'">External HCT centre</mat-option>
                                    <mat-option [value]="'OVC Partner'">OVC Partner</mat-option>
                                    <mat-option [value]="'In-patients'">In-patients</mat-option>
                                    <mat-option [value]="'Self-referral'">Self-referral</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-6">
                            <mat-form-field class="full-width">
                                <mat-label>Enrollment Setting</mat-label>
                                <mat-select name="enrollmentSetting" [(ngModel)]="entity.enrollmentSetting"
                                            [required]="true" #setting="ngModel">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'Facility'">Facility</mat-option>
                                    <mat-option [value]="'Community'">Community</mat-option>
                                </mat-select>
                                <mat-error
                                        *ngIf="setting.errors && (setting.dirty || setting.touched || !!entity.id) && (setting.errors.required)">
                                    Enrollment Setting is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="full-width"
                                            *ngIf="minDateConfirmed && entity.statusAtRegistration !== 'HIV_NEGATIVE'">
                                <mat-label>Date of Confirmed HIV Test</mat-label>
                                <input matInput [matDatepicker]="picker2"
                                       [(ngModel)]="entity.dateConfirmedHiv"
                                       #time="ngModel"
                                       [max]="maxDateConfirmed"
                                       [min]="minDateConfirmed"
                                       required
                                       name="time">
                                <mat-datepicker-toggle
                                        matSuffix
                                        [for]="picker2">
                                </mat-datepicker-toggle>
                                <mat-datepicker #picker2></mat-datepicker>
                                <mat-error
                                        *ngIf="time.errors && (time.dirty || time.touched || !!entity.id) && (time.errors.required)">
                                    Date of Confirmed HIV Test is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-md-6">
                            <mat-form-field class="full-width">
                                <mat-label>TB Status</mat-label>
                                <mat-select name="tbStatus" [(ngModel)]="entity.tbStatus">
                                    <mat-option></mat-option>
                                    <mat-option [value]="'No sign or symptoms of TB'">No sign or symptoms of TB
                                    </mat-option>
                                    <mat-option [value]="'TB suspected and referred for evaluation'">TB suspected and
                                        referred for evaluation
                                    </mat-option>
                                    <mat-option [value]="'Currently on INH prophylaxis'">Currently on INH prophylaxis
                                    </mat-option>
                                    <mat-option [value]="'Currently on TB treatment'">Currently on TB treatment
                                    </mat-option>
                                    <mat-option [value]="'TB positive not on TB drugs'">TB positive not on TB drugs
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </div>
                    <fieldset>
                        <legend>Next of kin/Treatment Supporter</legend>
                        <div class="row">
                            <div class="col-md-6">
                                <mat-form-field class="full-width">
                                    <mat-label>Name</mat-label>
                                    <input matInput name="nextKin" [(ngModel)]="entity.nextOfKin"/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-6">
                                <mat-form-field class="full-width">
                                    <mat-label>Relationship</mat-label>
                                    <mat-select name="relationKin" [(ngModel)]="entity.nextOfKinRelationship">
                                        <mat-option></mat-option>
                                        <mat-option [value]="'Aunt'">Aunt</mat-option>
                                        <mat-option [value]="'Brother'">Brother</mat-option>
                                        <mat-option [value]="'Cousin'">Cousin</mat-option>
                                        <mat-option [value]="'Daughter'">Daughter</mat-option>
                                        <mat-option [value]="'Father'">Father</mat-option>
                                        <mat-option [value]="'Friend'">Friend</mat-option>
                                        <mat-option [value]="'Grand parent'">Grand parent</mat-option>
                                        <mat-option [value]="'Mother'">Mother</mat-option>
                                        <mat-option [value]="'Sister'">Sister</mat-option>
                                        <mat-option [value]="'Son'">Son</mat-option>
                                        <mat-option [value]="'Spouse'">Spouse</mat-option>
                                        <mat-option [value]="'Treatment Supporter'">Treatment Supporter</mat-option>
                                        <mat-option [value]="'Uncle'">Uncle</mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <mat-form-field class="full-width">
                                    <mat-label>Address</mat-label>
                                    <input matInput name="addressKin" [(ngModel)]="entity.nextOfKinAddress"/>
                                </mat-form-field>
                            </div>
                            <div class="col-md-6">
                                <mat-form-field class="full-width">
                                    <mat-label>Telephone Number</mat-label>
                                    <input matInput name="phoneKin" phoneNumber [(ngModel)]="entity.nextOfKinPhone"
                                           #phone1="ngModel"/>
                                    <mat-error
                                            *ngIf="phone1.errors && (phone1.dirty || phone1.touched || !!entity.id) && (phone1.errors.invalidPhone)">
                                        Invalid phone number
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                    </fieldset>
                    <ng-container *ngIf="ovcApplicable">
                        <fieldset>
                            <legend>OVC</legend>
                            <div class="row">
                                <div class="col-md-6">
                                    <mat-form-field class="full-width">
                                        <mat-label>Household Unique No</mat-label>
                                        <input matInput name="householdUniqueNo" [(ngModel)]="ovc.householdUniqueNo"
                                               [required]="!!ovc.referredTo || !!ovc.referredFrom"
                                               #hun="ngModel"/>
                                        <mat-error
                                                *ngIf="hun.errors && (hun.dirty || hun.touched || !!entity.id) && (hun.errors.required)">
                                            Household Unique No is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <mat-form-field class="full-width"
                                                    *ngIf="!!ovc.referredFrom || !!ovc.dateReferredFrom || ovcMin">
                                        <mat-label>Referred To OVC Partner</mat-label>
                                        <input matInput name="referredTo" [(ngModel)]="ovc.referredTo"
                                               [required]="!!ovc.dateReferredTo"
                                               [disabled]="!!ovc.referredFrom || !!ovc.dateReferredFrom"
                                               #rt="ngModel"/>
                                        <mat-error
                                                *ngIf="rt.errors && (rt.dirty || rt.touched) && (rt.errors.required)">
                                            OVC Partner referred to is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-6">
                                    <mat-form-field class="full-width"
                                                    *ngIf="!!ovc.referredFrom || !!ovc.dateReferredFrom || ovcMin">
                                        <mat-label>Date Referred to OVC Partner</mat-label>
                                        <input matInput [matDatepicker]="picker8"
                                               [(ngModel)]="ovc.dateReferredTo"
                                               #drt="ngModel"
                                               [max]="today"
                                               [min]="ovcMin"
                                               [disabled]="!!ovc.referredFrom || !!ovc.dateReferredFrom"
                                               [required]="!!ovc.referredTo"
                                               name="drt">
                                        <mat-datepicker-toggle
                                                matSuffix
                                                [for]="picker8">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #picker8></mat-datepicker>
                                        <mat-error
                                                *ngIf="drt.errors && (drt.dirty || drt.touched) && (drt.errors.required)">
                                            Date Referred to OVC Partner is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <mat-form-field class="full-width"
                                                    *ngIf="!!ovc.referredTo || !!ovc.dateReferredTo || ovcMin">
                                        <mat-label>Referred From OVC Partner</mat-label>
                                        <input matInput name="referredFrom" [(ngModel)]="ovc.referredFrom"
                                               [required]="!!ovc.dateReferredFrom"
                                               [disabled]="!!ovc.referredTo || !!ovc.dateReferredTo"
                                               #rf="ngModel"/>
                                        <mat-error
                                                *ngIf="rf.errors && (rf.dirty || rf.touched) && (rf.errors.required)">
                                            OVC Partner referred from is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-6">
                                    <mat-form-field class="full-width"
                                                    *ngIf="!!ovc.referredTo || !!ovc.dateReferredTo || ovcMin">
                                        <mat-label>Date Referred From OVC Partner</mat-label>
                                        <input matInput [matDatepicker]="picker9"
                                               [(ngModel)]="ovc.dateReferredFrom"
                                               #drf="ngModel"
                                               [max]="today"
                                               [min]="ovcMin"
                                               [disabled]="!!ovc.referredTo || !!ovc.dateReferredTo"
                                               [required]="!!ovc.referredFrom"
                                               name="drf">
                                        <mat-datepicker-toggle
                                                matSuffix
                                                [for]="picker9">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #picker9></mat-datepicker>
                                        <mat-error
                                                *ngIf="drf.errors && (drf.dirty || drf.touched) && (drf.errors.required)">
                                            Date Referred to OVC Partner is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row" *ngIf="ovc.householdUniqueNo">
                                <div class="col-md-12">
                                    <mat-form-field class="full-width">
                                        <mat-label>Services Provided</mat-label>
                                        <mat-select name="services" [(ngModel)]="ovc.servicesProvided" multiple>
                                            <mat-option [value]="'Emergency Health Services'">Emergency Health
                                                Services
                                            </mat-option>
                                            <mat-option [value]="'Educational Support'">Educational Support</mat-option>
                                            <mat-option [value]="'Household Economic Strengthening'">Household Economic
                                                Strengthening
                                            </mat-option>
                                            <mat-option [value]="'Nutritional Support'">Nutritional Support</mat-option>
                                            <mat-option [value]="'Health Education'">Health Education</mat-option>
                                            <mat-option [value]="'Water, Sanitation &amp; Hygiene Messaging (WASH)'">
                                                Water, Sanitation &amp; Hygiene Messaging (WASH)
                                            </mat-option>
                                            <mat-option [value]="'ART Adherence Support'">ART Adherence Support
                                            </mat-option>
                                            <mat-option [value]="'Nutrition Assessment, Counseling and Support'">
                                                Nutrition Assessment, Counseling and Support
                                            </mat-option>
                                            <mat-option [value]="'Growth Monitoring'">Growth Monitoring</mat-option>
                                            <mat-option [value]="'Emergency Support'">Emergency Support</mat-option>
                                            <mat-option [value]="'School Enrollment/ Re-enrollment'">School Enrollment/
                                                Re-enrollment
                                            </mat-option>
                                            <mat-option [value]="'Psychosocial Support'">Psychosocial Support
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
                        </fieldset>
                    </ng-container>
                </mat-card-content>
                <mat-card-actions class="lamis-edit-form-actions">
                    <button mat-button type="button" (click)="previousState()">Back</button>
                    <button mat-raised-button color="primary" (click)="save()"
                            [disabled]="patientForm.invalid || isSaving || (!!ovc.householdUniqueNo && !(!!ovc.referredFrom || !!ovc.referredTo))">
                        {{entity.id ? 'Update' : 'Save'}}
                    </button>
                </mat-card-actions>
            </mat-card>
        </form>
    </div>
</div>
